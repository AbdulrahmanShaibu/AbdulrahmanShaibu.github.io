<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Maahad School Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #f8f9fa;
        }

        h1 {
            text-align: center;
            font-size: 2em;
            font-weight: bold;
        }

        h3 {
            border-bottom: 2px solid #0d6efd;
            padding-bottom: 8px;
            margin-bottom: 20px;
        }

        .tabs {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 20px 0;
            overflow-x: auto;
        }

        .tab-button {
            padding: 10px 15px;
            background-color: #e0e0e0;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            white-space: nowrap;
        }

        .tab-button.active {
            background-color: #1d4ed8;
            color: white;
            font-weight: bold;
        }

        .tab-content {
            display: none;
            margin-top: 20px;
        }

        .tab-content.active {
            display: block;
        }

        .card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.1);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }

        th,
        td {
            padding: 10px;
            border-bottom: 1px solid #ccc;
            text-align: left;
        }

        th {
            background-color: #f0f0f0;
        }

        .item-block {
            margin-bottom: 15px;
            padding: 10px;
            background-color: #f9f9f9;
            border-left: 4px solid #1d4ed8;
            border-radius: 5px;
        }

        input[type="text"],
        input[type="file"] {
            width: 100%;
            padding: 8px;
            margin-top: 4px;
            margin-bottom: 12px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .btn {
            padding: 10px 20px;
            background-color: #1d4ed8;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin-top: 10px;
        }

        .btn:hover {
            background-color: #2563eb;
        }

        /* Modal Alert Styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 100;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
        }

        .modal-content {
            background: white;
            padding: 20px;
            border-radius: 8px;
            width: 90%;
            max-width: 400px;
            margin: 100px auto;
            text-align: center;
        }

        .modal-content p {
            margin-bottom: 20px;
        }
    </style>

    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f4f7fc;
            color: #333;
        }

        h1 {
            text-align: center;
            font-size: 2em;
            font-weight: bold;
        }

        .tabs {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 20px 0;
            overflow-x: auto;
        }

        .tab-button {
            padding: 10px 15px;
            background-color: #e0e0e0;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            white-space: nowrap;
        }

        .tab-button.active {
            background-color: #1d4ed8;
            color: white;
            font-weight: bold;
        }

        .tab-content {
            display: none;
            margin-top: 20px;
        }

        .tab-content.active {
            display: block;
        }

        .card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.1);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }

        th,
        td {
            padding: 10px;
            border-bottom: 1px solid #ccc;
            text-align: left;
        }

        th {
            background-color: #f0f0f0;
        }

        .item-block {
            margin-bottom: 15px;
            padding: 10px;
            background-color: #f9f9f9;
            border-left: 4px solid #1d4ed8;
            border-radius: 5px;
        }

        input[type="text"],
        input[type="file"],
        input[type="email"] {
            width: 100%;
            padding: 8px;
            margin-top: 4px;
            margin-bottom: 12px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .btn {
            padding: 10px 20px;
            background-color: #1d4ed8;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin-top: 10px;
        }

        .btn:hover {
            background-color: #2563eb;
        }

        /* Alert Modal */
        .modal {
            display: none;
            position: fixed;
            z-index: 100;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
        }

        .modal-content {
            background: white;
            padding: 20px;
            border-radius: 8px;
            width: 90%;
            max-width: 400px;
            margin: 100px auto;
            text-align: center;
        }

        .modal-content p {
            margin-bottom: 20px;
        }

        /* Pop-up form modal */
        .form-modal-content {
            background: white;
            padding: 30px;
            border-radius: 10px;
            width: 90%;
            max-width: 500px;
            margin: 80px auto;
        }

        .form-modal-content h3 {
            margin-bottom: 20px;
        }

        .form-modal-content .btn-group {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }

        .lms-card {
            padding: 20px;
            border-radius: 10px;
            background-color: #f8f9fa;
            box-shadow: 0 0 10px rgba(0, 123, 255, 0.1);
        }

        .lms-title {
            color: #004080;
            margin-bottom: 20px;
            font-size: 24px;
            font-weight: bold;
        }

        .lms-material {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: #fff;
            padding: 15px 20px;
            margin-bottom: 15px;
            border-left: 5px solid #007BFF;
            border-radius: 6px;
            transition: background 0.3s;
        }

        .lms-material:hover {
            background: #f1f9ff;
        }

        .material-info p {
            margin: 4px 0 0;
            color: #555;
            font-size: 14px;
        }

        .lms-button {
            padding: 8px 15px;
            border-radius: 4px;
            text-decoration: none;
            color: white;
            font-weight: bold;
            transition: background 0.3s;
        }

        .lms-button.download {
            background-color: #28a745;
        }

        .lms-button.download:hover {
            background-color: #218838;
        }

        .lms-button.view {
            background-color: #17a2b8;
        }

        .lms-button.view:hover {
            background-color: #138496;
        }
    </style>

</head>

<body>

    <!-- <h1>Maahad School Management System</h1> -->

    <div class="tabs" id="tabs">
        <button class="tab-button active" onclick="showTab('teachers')">Teachers</button>
        <button class="tab-button" onclick="showTab('students')">Student Marks</button>
        <button class="tab-button" onclick="showTab('lms')">E-Learning</button>
        <button class="tab-button" onclick="showTab('payments')">Payments</button>
        <button class="tab-button" onclick="showTab('almanac')">Almanac</button>
        <button class="tab-button" onclick="showTab('curriculum')">Curriculum</button>
        <button class="tab-button" onclick="showTab('results')">Results</button>
        <button class="tab-button" onclick="showTab('services')">Services</button>
        <button class="tab-button" onclick="showTab('lessons')">Lessons</button>
        <button class="tab-button" onclick="showTab('videos')">Video Lessons</button>
        <button class="tab-button" onclick="showTab('live')">Live Classes</button>
    </div>

    <!-- Teachers Tab -->
    <div id="teachers" class="tab-content active">
        <div class="card">
            <!-- üîò NEW Button to Open Pop-Up Form -->
            <div
                style="display: flex; justify-content: space-between; align-items: center; padding: 10px 20px; background-color: #f0f4f8; border-radius: 8px; box-shadow: 0 2px 6px rgba(0,0,0,0.1);">
                <h3 style="margin: 0; font-size: 24px; color: #333;">All Teachers</h3>
                <button onclick="openFormModal()"
                    style="padding: 8px 16px; background-color: #007BFF; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 14px;">
                    Add New Teacher
                </button>
            </div>

            <!-- Alert Modal -->
            <div class="modal" id="alertModal">
                <div class="modal-content">
                    <p id="alertMessage"></p>
                    <button class="btn" onclick="closeModal()">OK</button>
                </div>
            </div>

            <!-- ‚úÖ New Pop-Up Form Modal -->
            <div class="modal" id="formModal">
                <div class="form-modal-content">
                    <!-- Personal Information -->
                    <input type="text" id="formName" placeholder="Full Name" required />
                    <input type="email" id="formEmail" placeholder="Email Address" required />
                    <input type="tel" id="formPhone" placeholder="Phone Number" required />
                    <input type="date" id="formDOB" placeholder="Date of Birth" required />

                    <!-- Academic & Employment Details -->
                    <input type="text" id="formSubject" placeholder="Teaching Subject" required />
                    <input type="text" id="formPosition" placeholder="Position (e.g., Senior Teacher, Assistant)"
                        required />
                    <input type="text" id="formEmployeeID" placeholder="Employee ID / Staff Number" required />
                    <input type="text" id="formDepartment" placeholder="Department (e.g., Science, Humanities)"
                        required />

                    <!-- Qualifications -->
                    <input type="text" id="formQualification" placeholder="Highest Qualification (e.g., B.Ed, M.Ed)"
                        required />
                    <input type="text" id="formInstitution" placeholder="Graduated Institution" required />
                    <input type="number" id="formExperience" placeholder="Years of Teaching Experience" required />

                    <!-- Address & Gender -->
                    <input type="text" id="formAddress" placeholder="Residential Address" required />
                    <select id="formGender" required>
                        <option value="">Select Gender</option>
                        <option value="Male">Male</option>
                        <option value="Female">Female</option>
                        <option value="Other">Other</option>
                    </select>

                    <!-- Profile Image -->
                    <label for="formImage">Upload Profile Image:</label>
                    <input type="file" id="formImage" accept="image/*" required />

                    <div class="btn-group">
                        <button class="btn" onclick="submitForm()">Submit</button>
                        <button class="btn" onclick="closeFormModal()">Cancel</button>
                    </div>
                </div>
            </div>

            <script>
                function showTab(tabId) {
                    document.querySelectorAll(".tab-button").forEach(btn => btn.classList.remove("active"));
                    document.querySelectorAll(".tab-content").forEach(tab => tab.classList.remove("active"));
                    document.querySelector(`[onclick="showTab('${tabId}')"]`).classList.add("active");
                    document.getElementById(tabId).classList.add("active");
                }

                function uploadVideo() {
                    const title = document.getElementById("videoTitle").value;
                    if (title) {
                        showAlert("Video '" + title + "' uploaded successfully.");
                    } else {
                        showAlert("Please enter a video title.");
                    }
                }

                function startClass() {
                    const link = document.getElementById("liveLink").value;
                    if (link) {
                        window.open(link, '_blank');
                    } else {
                        showAlert("Enter a valid live class link.");
                    }
                }

                function showAlert(message) {
                    document.getElementById("alertMessage").innerText = message;
                    document.getElementById("alertModal").style.display = "block";
                }

                function closeModal() {
                    document.getElementById("alertModal").style.display = "none";
                }

                // üìå New: Form Modal Functions
                function openFormModal() {
                    document.getElementById("formModal").style.display = "block";
                }

                function closeFormModal() {
                    document.getElementById("formModal").style.display = "none";
                }

                function submitForm() {
                    const name = document.getElementById("formName").value;
                    const email = document.getElementById("formEmail").value;
                    const role = document.getElementById("formRole").value;

                    if (!name || !email || !role) {
                        alert("Please fill in all fields.");
                        return;
                    }

                    closeFormModal();
                    showAlert("Form submitted successfully for " + name + ".");
                }
            </script>
            <!-- Filter Input -->
            <div style="margin: 20px 0;">
                <input type="text" id="teacherFilter" onkeyup="filterTeachers()"
                    placeholder="Search by name or subject..."
                    style="width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 6px; font-size: 16px;">
            </div>

            <div style="display: flex; flex-wrap: wrap; gap: 20px; font-family: Arial, sans-serif;">

                <!-- Example Card -->
                <div
                    style="border: 1px solid #ddd; border-radius: 10px; width: 320px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); overflow: hidden; background-color: #fff;">
                    <img src="https://via.placeholder.com/320x180?text=Ustadh+Abdulrahman" alt="Ustadh Abdulrahman"
                        style="width: 100%; height: auto;">
                    <div style="padding: 15px;">
                        <h3 style="margin: 0 0 8px;">Ustadh Abdulrahman</h3>
                        <p style="margin: 4px 0;"><strong>Email:</strong> abdul@maahad.com</p>
                        <p style="margin: 4px 0;"><strong>Phone:</strong> +255 712 345 678</p>
                        <p style="margin: 4px 0;"><strong>Subject:</strong> Fiqh</p>
                        <p style="margin: 4px 0;"><strong>Department:</strong> Islamic Studies</p>
                        <p style="margin: 4px 0;"><strong>Position:</strong> Senior Teacher</p>
                        <p style="margin: 4px 0;"><strong>Experience:</strong> 8 years</p>
                        <p style="margin: 4px 0;"><strong>Gender:</strong> Male</p>
                        <p style="margin: 4px 0;"><strong>Qualification:</strong> B.Ed in Sharia</p>
                        <p style="margin: 4px 0;"><strong>Institution:</strong> Islamic University Uganda</p>
                        <p style="margin: 4px 0;"><strong>Address:</strong> Kariakoo, Dar es Salaam</p>
                        <div style="margin-top: 12px;">
                            <button
                                style="background-color: #ffc107; border: none; padding: 6px 12px; color: white; border-radius: 4px; cursor: pointer; margin-right: 8px;"
                                onclick="updateTeacher(this)">Update</button>
                            <button
                                style="background-color: #dc3545; border: none; padding: 6px 12px; color: white; border-radius: 4px; cursor: pointer;"
                                onclick="deleteTeacher(this)">Delete</button>
                        </div>
                    </div>
                </div>

                <!-- Duplicate the above card for each teacher -->

            </div>



            <!-- JavaScript -->
            <script>
                function filterTeachers() {
                    const input = document.getElementById("teacherFilter").value.toLowerCase();
                    const rows = document.getElementById("teacherTable").getElementsByTagName("tr");
                    for (let i = 0; i < rows.length; i++) {
                        const name = rows[i].cells[0].textContent.toLowerCase();
                        const subject = rows[i].cells[1].textContent.toLowerCase();
                        if (name.includes(input) || subject.includes(input)) {
                            rows[i].style.display = "";
                        } else {
                            rows[i].style.display = "none";
                        }
                    }
                }

                function deleteTeacher(button) {
                    if (confirm("Are you sure you want to delete this teacher?")) {
                        const row = button.closest("tr");
                        row.remove();
                    }
                }

                function updateTeacher(button) {
                    alert("Update function to be implemented.");
                }
            </script>

        </div>
    </div>

    <!-- Student Marks Tab -->
    <div id="students" class="tab-content">
        <div class="card">
            <hr style="color: #007BFF;">

            <div style="display: flex; flex-wrap: wrap; gap: 10px; margin-bottom: 10px;">
                <input type="text" id="searchInput" placeholder="Search name..."
                    style="padding: 8px; border-radius: 5px; border: 1px solid #ccc;">
                <select id="termFilter" style="padding: 8px;">
                    <option value="">All Terms</option>
                    <option value="Term 1">Term 1</option>
                    <option value="Term 2">Term 2</option>
                </select>
                <select id="subjectFilter" style="padding: 8px;">
                    <option value="">All Subjects</option>
                    <option value="Quran">Quran</option>
                    <option value="Arabic">Arabic</option>
                    <option value="Tajweed">Tajweed</option>
                    <option value="Hadith">Hadith</option>
                    <option value="Aqidah">Aqidah</option>
                    <option value="Fiqh">Fiqh</option>
                    <option value="History">History</option>
                </select>
                <button onclick="exportToPDF()"
                    style="padding: 8px 15px; background-color: #004080; color: white; border: none; border-radius: 4px;">Export
                    PDF</button>
                <button onclick="exportToExcel()"
                    style="padding: 8px 15px; background-color: #4CAF50; color: white; border: none; border-radius: 4px;">Export
                    Excel</button>

                <!-- Button to open the popup form -->
                <button onclick="openAddForm()"
                    style="padding: 8px 15px; background-color: #007BFF; color: white; border: none; border-radius: 4px; margin-left: 10px;">
                    Add Student Marks
                </button>

                <!-- Popup form modal -->
                <div id="addFormModal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; 
    background: rgba(0,0,0,0.5); justify-content:center; align-items:center;">
                    <div style="background:white; padding:20px; border-radius:6px; width:300px; position:relative;">
                        <h3 style="margin-top:0;">Add Student Marks</h3>
                        <form id="addMarksForm">
                            <input type="text" id="studentId" placeholder="Student ID" required
                                style="width:100%; padding:8px; margin-bottom:10px; border-radius:4px; border:1px solid #ccc;">
                            <input type="text" id="studentName" placeholder="Student Name" required
                                style="width:100%; padding:8px; margin-bottom:10px; border-radius:4px; border:1px solid #ccc;">
                            <select id="subject" required
                                style="width:100%; padding:8px; margin-bottom:10px; border-radius:4px; border:1px solid #ccc;">
                                <option value="" disabled selected>Select Subject</option>
                                <option value="Quran">Quran</option>
                                <option value="Arabic">Arabic</option>
                                <option value="Tajweed">Tajweed</option>
                                <option value="Hadith">Hadith</option>
                                <option value="Aqidah">Aqidah</option>
                                <option value="Fiqh">Fiqh</option>
                                <option value="History">History</option>
                            </select>
                            <select id="term" required
                                style="width:100%; padding:8px; margin-bottom:10px; border-radius:4px; border:1px solid #ccc;">
                                <option value="" disabled selected>Select Term</option>
                                <option value="Term 1">Term 1</option>
                                <option value="Term 2">Term 2</option>
                            </select>
                            <input type="number" id="marks" placeholder="Marks" min="0" max="100" required
                                style="width:100%; padding:8px; margin-bottom:10px; border-radius:4px; border:1px solid #ccc;">
                            <div style="display:flex; justify-content:flex-end; gap:10px;">
                                <button type="button" onclick="closeAddForm()"
                                    style="padding: 6px 12px; background:#ccc; border:none; border-radius:4px;">Cancel</button>
                                <button type="submit"
                                    style="padding: 6px 12px; background:#28a745; color:white; border:none; border-radius:4px;">Add</button>
                            </div>
                        </form>
                    </div>
                </div>

                <script>
                    function openAddForm() {
                        document.getElementById('addFormModal').style.display = 'flex';
                    }
                    function closeAddForm() {
                        document.getElementById('addFormModal').style.display = 'none';
                    }

                    document.getElementById('addMarksForm').addEventListener('submit', function (e) {
                        e.preventDefault();
                        const id = document.getElementById('studentId').value.trim();
                        const name = document.getElementById('studentName').value.trim();
                        const subject = document.getElementById('subject').value;
                        const term = document.getElementById('term').value;
                        const marks = parseInt(document.getElementById('marks').value);

                        // Add new record to rawData
                        rawData.push({ id, name, subject, term, marks });

                        // Refresh the table display with the new data
                        filterAndRender();

                        // Close the form and reset it
                        closeAddForm();
                        this.reset();
                    });
                </script>

            </div>

            <table class="custom-table" id="studentTable">
                <thead>
                    <tr>
                        <th>Student ID</th>
                        <th>Student Name</th>
                        <th>Subject</th>
                        <th>Term</th>
                        <th>Marks</th>
                    </tr>
                </thead>
                <tbody id="studentBody">
                    <!-- Data will be dynamically rendered -->
                </tbody>
            </table>

            <div class="pagination" id="pagination"></div>

            <style>
                .green {
                    color: green;
                    font-weight: bold;
                }

                .orange {
                    color: orange;
                    font-weight: bold;
                }

                .red {
                    color: red;
                    font-weight: bold;
                }

                .category-tabs {
                    display: flex;
                    gap: 10px;
                    margin-bottom: 20px;
                    flex-wrap: wrap;
                }

                .category-tabs button {
                    padding: 8px 14px;
                    border: none;
                    background-color: #e0e0e0;
                    border-radius: 20px;
                    cursor: pointer;
                }

                .category-tabs button.active {
                    background-color: #007BFF;
                    color: #fff;
                }

                .lms-material {
                    padding: 12px;
                    border: 1px solid #ccc;
                    margin-bottom: 10px;
                    border-left: 5px solid #007BFF;
                    border-radius: 6px;
                    background-color: #fff;
                }

                .add-material-form {
                    margin-top: 30px;
                    padding-top: 20px;
                    border-top: 2px solid #ddd;
                }

                .add-material-form input,
                .add-material-form textarea,
                .add-material-form select {
                    width: 100%;
                    padding: 10px;
                    margin: 8px 0;
                    border-radius: 6px;
                    border: 1px solid #ccc;
                }

                .lms-button.add {
                    background-color: #28a745;
                    color: #fff;
                    padding: 10px 20px;
                    border: none;
                    border-radius: 6px;
                    cursor: pointer;
                }
            </style>

            <script>
                const rawData = [
                    { id: "ST001", name: "Amina Yusuf", subject: "Quran", term: "Term 1", marks: 95 },
                    { id: "ST001", name: "Amina Yusuf", subject: "Arabic", term: "Term 1", marks: 88 },
                    { id: "ST001", name: "Amina Yusuf", subject: "Tajweed", term: "Term 2", marks: 90 },
                    { id: "ST002", name: "Bilal Ahmed", subject: "Hadith", term: "Term 1", marks: 88 },
                    { id: "ST002", name: "Bilal Ahmed", subject: "Aqidah", term: "Term 2", marks: 84 },
                    { id: "ST003", name: "Khadija Omar", subject: "Arabic", term: "Term 2", marks: 91 },
                    { id: "ST003", name: "Khadija Omar", subject: "Fiqh", term: "Term 2", marks: 87 },
                    { id: "ST004", name: "Mohamed Said", subject: "Fiqh", term: "Term 1", marks: 84 },
                    { id: "ST004", name: "Mohamed Said", subject: "History", term: "Term 1", marks: 78 },
                    { id: "ST005", name: "Fatma Musa", subject: "Tajweed", term: "Term 2", marks: 89 },
                    { id: "ST005", name: "Fatma Musa", subject: "Arabic", term: "Term 1", marks: 85 },
                ];

                const tbody = document.getElementById("studentBody");

                function getColorClass(marks) {
                    if (marks >= 90) return "green";
                    if (marks >= 70) return "orange";
                    return "red";
                }

                function groupAndRender(data) {
                    tbody.innerHTML = "";
                    const grouped = {};

                    data.forEach(item => {
                        if (!grouped[item.id]) {
                            grouped[item.id] = { name: item.name, records: [] };
                        }
                        grouped[item.id].records.push(item);
                    });

                    for (let id in grouped) {
                        const student = grouped[id];
                        const row = document.createElement("tr");
                        row.className = "student-name-row";
                        row.innerHTML = `<td>${id}</td><td>${student.name}</td><td colspan="3"></td>`;
                        tbody.appendChild(row);

                        const termMarks = {};
                        let total = 0, count = 0;

                        student.records.forEach(rec => {
                            const tr = document.createElement("tr");
                            tr.innerHTML = `<td></td><td></td><td>${rec.subject}</td><td>${rec.term}</td><td class="${getColorClass(rec.marks)}">${rec.marks}</td>`;
                            tbody.appendChild(tr);

                            // Calculations
                            total += rec.marks;
                            count++;
                            termMarks[rec.term] = termMarks[rec.term] || [];
                            termMarks[rec.term].push(rec.marks);
                        });

                        for (let term in termMarks) {
                            const avg = (termMarks[term].reduce((a, b) => a + b) / termMarks[term].length).toFixed(2);
                            const tr = document.createElement("tr");
                            tr.innerHTML = `<td></td><td></td><td colspan="2"><strong>${term} Avg</strong></td><td><strong>${avg}</strong></td>`;
                            tbody.appendChild(tr);
                        }

                        const gpa = (total / count).toFixed(2);
                        const tr = document.createElement("tr");
                        tr.innerHTML = `<td></td><td></td><td colspan="2"><strong>Overall GPA</strong></td><td><strong>${gpa}</strong></td>`;
                        tbody.appendChild(tr);
                    }
                }

                function filterAndRender() {
                    const term = document.getElementById("termFilter").value;
                    const subject = document.getElementById("subjectFilter").value;
                    const name = document.getElementById("searchInput").value.toLowerCase();

                    const filtered = rawData.filter(item =>
                        (term === "" || item.term === term) &&
                        (subject === "" || item.subject === subject) &&
                        (name === "" || item.name.toLowerCase().includes(name))
                    );

                    groupAndRender(filtered);
                }

                document.getElementById("termFilter").addEventListener("change", filterAndRender);
                document.getElementById("subjectFilter").addEventListener("change", filterAndRender);
                document.getElementById("searchInput").addEventListener("input", filterAndRender);

                filterAndRender();

                // PDF Export
                function exportToPDF() {
                    const { jsPDF } = window.jspdf;
                    const doc = new jsPDF();
                    doc.text("Student Marks Report", 10, 10);
                    doc.autoTable({ html: "#studentTable", startY: 20 });
                    doc.save("student_marks.pdf");
                }

                // Excel Export
                function exportToExcel() {
                    const ws = XLSX.utils.table_to_sheet(document.getElementById('studentTable'));
                    const wb = XLSX.utils.book_new();
                    XLSX.utils.book_append_sheet(wb, ws, "Student Marks");
                    XLSX.writeFile(wb, "student_marks.xlsx");
                }
            </script>
        </div>
    </div>

    <!-- Dependencies -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.23/jspdf.plugin.autotable.min.js"></script>




    <!-- LMS Tab -->
    <div id="lms" class="tab-content">
        <div class="card lms-card">
            <h3 class="lms-title">üìö Lesson Materials</h3>

            <!-- Category Tabs -->
            <div class="category-tabs">
                <button onclick="filterCategory('all')" class="active">All</button>
                <button onclick="filterCategory('fiqh')">Fiqh</button>
                <button onclick="filterCategory('arabic')">Arabic</button>
                <button onclick="filterCategory('hadith')">Hadith</button>
            </div>

            <!-- Materials List -->
            <div id="materialsList">
                <div class="lms-material" data-category="fiqh">
                    <div class="material-info">
                        <strong>Fiqh Basics</strong>
                        <p>Comprehensive PDF covering foundational principles of Fiqh.</p>
                    </div>
                    <a href="#" class="lms-button download">‚¨áÔ∏è Download PDF</a>
                </div>

                <div class="lms-material" data-category="arabic">
                    <div class="material-info">
                        <strong>Arabic Grammar 101</strong>
                        <p>Structured notes for beginner Arabic learners.</p>
                    </div>
                    <a href="#" class="lms-button view">üìù View Notes</a>
                </div>

                <div class="lms-material" data-category="hadith">
                    <div class="material-info">
                        <strong>Hadith Compilation</strong>
                        <p>Selected Hadiths organized thematically for learning.</p>
                    </div>
                    <a href="#" class="lms-button download">üìñ Download PDF</a>
                </div>
            </div>

            <!-- Add Material Form -->
            <div class="add-material-form">
                <h4>Add New Material</h4>
                <form id="materialForm" onsubmit="addMaterial(event)">
                    <input type="text" id="materialTitle" placeholder="Title" required />
                    <textarea id="materialDescription" placeholder="Description" required></textarea>
                    <select id="materialCategory" required>
                        <option value="">Select Category</option>
                        <option value="fiqh">Fiqh</option>
                        <option value="arabic">Arabic</option>
                        <option value="hadith">Hadith</option>
                    </select>
                    <input type="url" id="materialLink" placeholder="Material Link (URL)" required />
                    <button type="submit" class="lms-button add">‚ûï Add Material</button>
                </form>
            </div>
        </div>
    </div>

    <script>
        function filterCategory(category) {
            const materials = document.querySelectorAll(".lms-material");
            const buttons = document.querySelectorAll(".category-tabs button");
            buttons.forEach(btn => btn.classList.remove("active"));
            event.target.classList.add("active");

            materials.forEach(mat => {
                if (category === 'all' || mat.dataset.category === category) {
                    mat.style.display = "block";
                } else {
                    mat.style.display = "none";
                }
            });
        }

        function addMaterial(event) {
            event.preventDefault();

            const title = document.getElementById("materialTitle").value;
            const desc = document.getElementById("materialDescription").value;
            const category = document.getElementById("materialCategory").value;
            const link = document.getElementById("materialLink").value;

            const newMaterial = document.createElement("div");
            newMaterial.className = "lms-material";
            newMaterial.setAttribute("data-category", category);
            newMaterial.innerHTML = `
    <div class="material-info">
      <strong>${title}</strong>
      <p>${desc}</p>
    </div>
    <a href="${link}" class="lms-button download" target="_blank">üîó Open Material</a>
  `;

            document.getElementById("materialsList").appendChild(newMaterial);
            document.getElementById("materialForm").reset();
        }
    </script>


    <!-- Payments Tab -->
    <!-- Payment Tab -->
    <div id="payments" class="tab-content">
        <div class="card">
            <div class="d-flex justify-content-between align-items-center mb-3">
                <h3>üí∞ Student Payments</h3>
                <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addPaymentModal">‚ûï Add
                    Payment</button>
            </div>

            <table class="table table-bordered table-hover">
                <thead class="table-light">
                    <tr>
                        <th>Student</th>
                        <th>Month</th>
                        <th>Amount</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Amina Said</td>
                        <td>May 2025</td>
                        <td>sh. 30,000</td>
                        <td><span class="badge bg-success">Paid</span></td>
                    </tr>
                    <tr>
                        <td>Fatma Noor</td>
                        <td>May 2025</td>
                        <td>sh. 30,000</td>
                        <td><span class="badge bg-danger">Unpaid</span></td>
                    </tr>
                    <tr>
                        <td>Hussein Ali</td>
                        <td>May 2025</td>
                        <td>sh. 50,000</td>
                        <td><span class="badge bg-danger">Unpaid</span></td>
                    </tr>
                    <tr>
                        <td>Said Noor</td>
                        <td>May 2025</td>
                        <td>sh. 70,000</td>
                        <td><span class="badge bg-danger">Unpaid</span></td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>


    <!-- Almanac Tab -->
    <div id="almanac" class="tab-content p-4">
        <div class="card shadow-sm">
            <div class="card-header bg-primary text-white">
                <h4 class="mb-0">üìò School Almanac - Academic Year 2025</h4>
            </div>
            <div class="card-body">
                <div class="timeline">
                    <div class="timeline-item">
                        <div class="timeline-icon bg-success text-white">üìÖ</div>
                        <div class="timeline-content">
                            <h6 class="mb-1 fw-bold">Term 1 Starts</h6>
                            <p class="text-muted">Monday, January 8</p>
                        </div>
                    </div>

                    <div class="timeline-item">
                        <div class="timeline-icon bg-warning text-dark">üìù</div>
                        <div class="timeline-content">
                            <h6 class="mb-1 fw-bold">Mid-Term Exam</h6>
                            <p class="text-muted">Tuesday, February 20</p>
                        </div>
                    </div>

                    <div class="timeline-item">
                        <div class="timeline-icon bg-info text-white">üïå</div>
                        <div class="timeline-content">
                            <h6 class="mb-1 fw-bold">Ramadhan Break</h6>
                            <p class="text-muted">March 10 ‚Äì April 10</p>
                        </div>
                    </div>

                    <div class="timeline-item">
                        <div class="timeline-icon bg-danger text-white">üìò</div>
                        <div class="timeline-content">
                            <h6 class="mb-1 fw-bold">End-Term Exam</h6>
                            <p class="text-muted">Monday, April 25</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <style>
        .timeline {
            position: relative;
            margin-left: 1rem;
        }

        .timeline::before {
            content: '';
            position: absolute;
            top: 0;
            left: 20px;
            width: 4px;
            height: 100%;
            background: #dee2e6;
        }

        .timeline-item {
            position: relative;
            margin-bottom: 2rem;
            padding-left: 3rem;
        }

        .timeline-icon {
            position: absolute;
            left: -8px;
            top: 0;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            font-size: 1.2rem;
            text-align: center;
            line-height: 32px;
        }

        .timeline-content {
            background: #f8f9fa;
            padding: 0.75rem 1rem;
            border-radius: 0.5rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
        }
    </style>


    <!-- Curriculum Tab -->
    <div id="curriculum" class="tab-content p-4">
        <div class="card shadow-sm">
            <div class="card-header bg-success text-white">
                <h4 class="mb-0">üìö School Curriculum</h4>
            </div>
            <div class="card-body">
                <ul class="list-group list-group-flush">
                    <li class="list-group-item d-flex align-items-center">
                        <span class="badge bg-primary me-3 fs-5">üìñ</span>
                        <div>
                            <h6 class="mb-0 fw-semibold">Fiqh</h6>
                            <small class="text-muted">Imam Shafi‚Äôi Curriculum</small>
                        </div>
                    </li>
                    <li class="list-group-item d-flex align-items-center">
                        <span class="badge bg-warning me-3 fs-5">üìú</span>
                        <div>
                            <h6 class="mb-0 fw-semibold">Quran</h6>
                            <small class="text-muted">Hafs 'an 'Asim (with Tajweed)</small>
                        </div>
                    </li>
                    <li class="list-group-item d-flex align-items-center">
                        <span class="badge bg-info me-3 fs-5">üìù</span>
                        <div>
                            <h6 class="mb-0 fw-semibold">Arabic Language</h6>
                            <small class="text-muted">Madinah Books</small>
                        </div>
                    </li>
                </ul>
            </div>
        </div>
    </div>


    <!-- Results Tab -->
    <div id="results" class="tab-content p-4">
        <div class="card shadow-sm border-0">
            <div class="card-header bg-primary text-white">
                <h4 class="mb-0">üìä Results History</h4>
            </div>
            <div class="card-body">
                <div class="list-group">
                    <div class="list-group-item d-flex justify-content-between align-items-center">
                        <div>
                            <h6 class="mb-1">Academic Year: <strong>2022</strong></h6>
                            <small class="text-muted">Performance Overview</small>
                        </div>
                        <span class="badge bg-success fs-6">85% Pass</span>
                    </div>
                    <div class="list-group-item d-flex justify-content-between align-items-center">
                        <div>
                            <h6 class="mb-1">Academic Year: <strong>2023</strong></h6>
                            <small class="text-muted">Improved Overall Results</small>
                        </div>
                        <span class="badge bg-success fs-6">92% Pass</span>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <!-- Services Tab -->
    <div id="services" class="tab-content p-4">
        <div class="card shadow-sm border-0">
            <div class="card-header bg-primary text-white">
                <h4 class="mb-0">üéì School Services</h4>
            </div>
            <div class="card-body">
                <div class="row g-4">
                    <div class="col-md-4">
                        <div class="border rounded p-3 h-100 d-flex align-items-start gap-3 bg-light">
                            <span class="fs-3 text-primary">üöå</span>
                            <div>
                                <h6 class="mb-1 fw-bold">Student Transport</h6>
                                <p class="mb-0 text-muted">Safe and timely transportation to all local districts.</p>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-4">
                        <div class="border rounded p-3 h-100 d-flex align-items-start gap-3 bg-light">
                            <span class="fs-3 text-primary">üìö</span>
                            <div>
                                <h6 class="mb-1 fw-bold">Islamic Library</h6>
                                <p class="mb-0 text-muted">Access over 2,000 curated Islamic books for learning and
                                    research.</p>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-4">
                        <div class="border rounded p-3 h-100 d-flex align-items-start gap-3 bg-light">
                            <span class="fs-3 text-primary">üçΩÔ∏è</span>
                            <div>
                                <h6 class="mb-1 fw-bold">On-Campus Meals</h6>
                                <p class="mb-0 text-muted">Nutritious halal meals prepared daily for students and staff.
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <!-- Lessons Tab -->
    <div id="lessons" class="tab-content p-4">
        <div class="card shadow-sm border-0">
            <div class="card-header bg-success text-white">
                <h4 class="mb-0">üì∫ Online Lessons</h4>
            </div>
            <div class="card-body">
                <p class="text-muted">Access recorded lessons for continuous learning:</p>
                <ul class="list-group list-group-flush">
                    <li class="list-group-item d-flex align-items-center justify-content-between">
                        <div>
                            <strong>üìñ Quran Lesson 1</strong><br>
                            <small class="text-muted">Surah Al-Fatihah</small>
                        </div>
                        <a href="https://youtu.be/sample" target="_blank"
                            class="btn btn-outline-success btn-sm">Watch</a>
                    </li>
                    <li class="list-group-item d-flex align-items-center justify-content-between">
                        <div>
                            <strong>üó£Ô∏è Arabic Grammar</strong><br>
                            <small class="text-muted">Arabic Verb Forms</small>
                        </div>
                        <a href="https://youtu.be/sample" target="_blank"
                            class="btn btn-outline-success btn-sm">Watch</a>
                    </li>
                </ul>
            </div>
        </div>
    </div>


    <!-- Video Lessons Tab -->
    <div id="videos" class="tab-content p-4">
        <div class="card shadow-sm border-0">
            <div class="card-header bg-primary text-white">
                <h4 class="mb-0">üé• Upload Video Lesson</h4>
            </div>
            <div class="card-body">
                <form onsubmit="uploadVideo(); return false;">
                    <div class="row g-3 mb-3">
                        <div class="col-md-4">
                            <label for="videoTitle" class="form-label">Video Title</label>
                            <input type="text" class="form-control" id="videoTitle" placeholder="e.g. Fiqh of Salah"
                                required />
                        </div>
                        <div class="col-md-4">
                            <label for="videoFile" class="form-label">Upload Video</label>
                            <input type="file" class="form-control" id="videoFile" accept="video/*" required />
                        </div>
                        <div class="col-md-4">
                            <label for="subject" class="form-label">Subject</label>
                            <input type="text" class="form-control" id="subject" placeholder="e.g. Fiqh" required />
                        </div>
                    </div>
                    <button type="submit" class="btn btn-success">Upload Video</button>
                </form>

                <hr class="my-4" />

                <div>
                    <h6><strong>üì∫ Uploaded Videos</strong></h6>
                    <ul class="list-group">
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            <div>
                                <strong>Fiqh of Salah</strong> ‚Äì <span class="text-muted">12 mins</span>
                            </div>
                            <a href="#" class="btn btn-outline-primary btn-sm">Watch</a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>


    <!-- Live Classes Tab -->
    <div id="live" class="tab-content p-4">
        <div class="card shadow-sm border-0">
            <div class="card-header bg-danger text-white">
                <h4 class="mb-0">üì° Live Video Classes</h4>
            </div>
            <div class="card-body">
                <form onsubmit="startClass(); return false;">
                    <div class="mb-3">
                        <label for="liveLink" class="form-label">Live Class Link</label>
                        <input type="url" class="form-control" id="liveLink"
                            placeholder="https://meet.jit.si/maahad-fiqh-001" required />
                    </div>
                    <button type="submit" class="btn btn-primary">Start Live Class</button>
                </form>

                <hr class="my-4" />

                <div>
                    <h6><strong>üìÖ Upcoming Classes</strong></h6>
                    <ul class="list-group">
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            <div>
                                <strong>üî¥ Arabic Grammar</strong><br />
                                <small class="text-muted">Today at 11:00 AM</small>
                            </div>
                            <a href="https://meet.jit.si/arabic-class" target="_blank"
                                class="btn btn-outline-success btn-sm">Join</a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>


    <!-- Alert Modal -->
    <div class="modal" id="alertModal">
        <div class="modal-content">
            <p id="alertMessage"></p>
            <button class="btn" onclick="closeModal()">OK</button>
        </div>
    </div>

    <script>
        function showTab(tabId) {
            document.querySelectorAll(".tab-button").forEach(btn => btn.classList.remove("active"));
            document.querySelectorAll(".tab-content").forEach(tab => tab.classList.remove("active"));
            document.querySelector(`[onclick="showTab('${tabId}')"]`).classList.add("active");
            document.getElementById(tabId).classList.add("active");
        }

        function uploadVideo() {
            const title = document.getElementById("videoTitle").value;
            if (title) {
                showAlert("Video '" + title + "' uploaded successfully.");
            } else {
                showAlert("Please enter a video title.");
            }
        }

        function startClass() {
            const link = document.getElementById("liveLink").value;
            if (link) {
                window.open(link, '_blank');
            } else {
                showAlert("Enter a valid live class link.");
            }
        }

        function showAlert(message) {
            document.getElementById("alertMessage").innerText = message;
            document.getElementById("alertModal").style.display = "block";
        }

        function closeModal() {
            document.getElementById("alertModal").style.display = "none";
        }
    </script>

</body>

</html>